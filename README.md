# ClickNow - 定时自动化工具

<div align="center">

<img src="asset/logo.png" alt="Logo" width="120" />

**一款强大的 AutoJS 定时自动化脚本，支持精确时间同步、多任务调度和灵活的坐标采集**

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)
[![AutoJS](https://img.shields.io/badge/AutoJS-6.5+-brightgreen)](https://github.com/hyper-v-org/autojs)
[![Android](https://img.shields.io/badge/Android-12+-blue)](https://www.android.com/)

[功能介绍](#功能介绍) • [快速开始](#快速开始) • [配置教程](#配置教程) • [常见问题](#常见问题)

</div>

---

## 📱 功能介绍

### 🎯 核心功能

#### 1. **精确时间同步** ⏰
- 支持多平台时间源选择（华为云、阿里巴巴、腾讯、拼多多、京东）
- 自动 RTT（往返延迟）补偿，消除网络延迟影响
- 实时时间偏差显示，精确到 0.1 秒
- 自动在触发前 1 分钟重新同步，确保最高精度

#### 2. **定时任务执行** ⚡
- **主任务模式**：设置目标触发时间，副任务相对主任务偏移执行
- **多任务调度**：支持 1-N 个任务，按照触发时间自动排序执行
- **灵活偏移配置**：支持秒级和 0.1 秒精度的时间偏移（如 5.5s、-3.2s）
- **个性化参数**：每个任务可独立配置点击坐标、间隔、持续时间

#### 3. **悬浮窗实时显示** 👁️
- 实时显示当前时间（HH:MM:SS:d 格式）
- 显示主任务触发时间
- 支持拖动和双击暂停执行
- 优雅的阴影设计，不遮挡关键操作区域

#### 4. **坐标采集工具** 🎪
- **点击采集**：双击停止窗口自动收集坐标
- **交互式设置**：实时反馈当前点击次数和坐标
- **多次采集**：支持多次点击调整，取最后一次作为最终坐标

#### 5. **点击参数精细调控** 🎛️
- **间隔配置**：设置点击之间的间隔时间（毫秒）
- **持续时间**：控制每次点击按下的持续时间
- **总时长设置**：定义整个点击任务的总持续时间
- **实时计算**：显示当前配置的点击频率（次/秒）

#### 6. **智能任务管理** 📋
- **保存/加载**：自动保存任务配置到本地存储
- **编辑模式**：查看、编辑、删除已保存的任务
- **任务验证**：防止配置错误的任务创建

---

## 🚀 快速开始

### 前置要求

- **Android 设备**：Android 12 及以上（推荐）
- **AutoJS 应用**：v6.5 及以上版本
  - 下载地址：[AutoJS 官网](https://hyper-v.io/)
- **无障碍权限**：在系统设置中为 AutoJS 授予无障碍权限

### 安装步骤

#### 方式 1：直接运行脚本（推荐开发/测试）

1. **在 AutoJS IDE 中打开脚本**
   ```
   AutoJS IDE → 打开 → autoshop.js
   ```

2. **授权设置**
   - 第一次运行时会提示授予无障碍权限
   - 按照提示操作即可

3. **开始使用**
   ```
   点击 ▶ 运行 按钮启动脚本
   ```

#### 方式 2：打包为 APK（生产环境）

1. **生成签名证书**
   ```powershell
   # Windows PowerShell
   keytool.exe -genkey -alias my_app ^
     -keyalg RSA -keysize 2048 ^
     -keystore my-app.jks ^
     -validity 10000
   ```

2. **使用 AutoJS IDE 打包**
   ```
   菜单 → 打包 → APK → 选择 my-app.jks → 完成
   ```

3. **安装到设备**
   ```powershell
   adb install -r output.apk
   ```

---

## ⚙️ 配置教程

### 第一步：设置任务

1. 启动应用，选择 **⚙️ 设置**
2. 创建主任务（第一个任务）
   - 输入触发时间：`HH:MM:SS:d` 格式（例：`10:00:00:0`）
   - 通过点击屏幕采集点击坐标
   - 配置点击参数

3. 创建副任务（可选）
   - 输入时间偏移（秒数，如 `5.5` 或 `-3.2`）
   - 配置对应的点击参数

### 第二步：设置时间源

1. 选择 **⏱️ 设置时间源**
2. 选择时间同步源：
   - 🏢 华为云
   - 🛒 阿里巴巴
   - 🐧 腾讯
   - 🛍️ 拼多多
   - 🏪 京东（推荐）

### 第三步：运行脚本

1. 选择 **▶️ 运行**
2. 点击 **▶ 开始** 确认启动
3. 脚本会显示实时时间悬浮窗
4. 到达设定时间时自动执行任务

### 操作技巧

| 操作 | 效果 |
|------|------|
| **拖动悬浮窗** | 移动时间显示位置 |
| **双击悬浮窗** | 暂停/停止脚本执行 |
| **查看设置** | 编辑或删除已保存的任务 |

---

## 🔧 高级功能

### 网络延迟补偿

脚本使用 **RTT (Round Trip Time)** 算法自动补偿网络延迟：

```
实际时间 = 服务器时间 + (网络往返延迟 / 2)
```

**示例**：
- 网络延迟 100ms
- 原始偏差：-100ms
- 补偿后偏差：≈ 0ms ✅

### 多任务时间排序

脚本自动按触发时间对所有任务排序：

```
主任务（10:00:00:0）
  ├─ 副任务 1（偏移 +2.5s → 10:00:02:5）
  ├─ 副任务 2（偏移 -1.0s → 09:59:59:0）
  └─ 副任务 3（偏移 +5.0s → 10:00:05:0）

执行顺序：副任务2 → 主任务 → 副任务1 → 副任务3
```

### 点击参数优化

- **随机抖动**：在基础参数上添加随机波动，避免被检测为机器行为
- **圆形半径点击**：在指定坐标周围随机生成点击位置（半径 6px）
- **自适应频率**：显示实际点击频率（次/秒），便于调试

---

## 📊 使用场景

✅ **电商秒杀** - 精确控制秒杀时间  
✅ **定时抢购** - 支持多个商品同时下单  
✅ **自动化测试** - 稳定的定时任务执行  
✅ **游戏自动化** - 定时副本、日常任务  
✅ **日程提醒** - 定时推送、定时操作  

---

## 🐛 常见问题

### Q1: 脚本要求的权限有哪些？

**A:** 脚本需要以下权限：

| 权限 | 用途 | 必需 |
|------|------|------|
| `SYSTEM_ALERT_WINDOW` | 显示悬浮窗 | ✅ 是 |
| `BIND_ACCESSIBILITY_SERVICE` | 自动点击 | ✅ 是 |
| `INTERNET` | 同步服务器时间 | ✅ 是 |
| `VIBRATE` | 震动反馈 | ⚠️ 可选 |

### Q2: 为什么时间还是不准确？

**A:** 可能的原因和解决方案：

1. **手机时间与网络不同步**
   - 解决：设置 → 日期和时间 → 启用自动设置

2. **网络延迟过高**
   - 解决：切换网络或更换时间源

3. **时间源暂时不可用**
   - 解决：在设置中切换到其他时间源

### Q3: 支持多少个任务？

**A:** 理论上无限制。脚本会自动按触发时间排序执行。建议不超过 10 个以避免性能问题。

### Q4: 能否在后台运行？

**A:** **不能**。由于使用无障碍服务进行自动点击，脚本必须在前台运行。用户可以：
- 打开悬浮窗保持可见
- 使用分屏模式（部分设备支持）
- 锁屏前确保脚本已启动

### Q5: 点击坐标如何获取？

**A:** 脚本内置坐标采集工具：

1. 进入设置模式 → 第一步设置坐标
2. 在坐标采集窗口点击目标位置（可点击多次）
3. **双击悬浮窗停止**采集
4. 脚本自动使用最后一次点击的坐标

### Q6: APK 被检测为恶意应用怎么办？

**A:** 参考 [APK优化指南.md](APK优化指南.md)：

- 使用正规有效期签名证书
- 减少敏感权限申请
- 隐藏敏感字符串
- 上传到官方应用市场

---

## 📈 版本历史

### v3.2 (当前版本)
- ✨ 添加网络延迟补偿（RTT 算法）
- ✨ 支持多时间源选择
- ✨ 改进悬浮窗设计（阴影效果）
- 🐛 修复浮点数偏移精度问题
- 🐛 改进窗口居中逻辑

### v3.1
- ✨ 多任务支持与时间排序
- ✨ 任务编辑功能
- 🐛 修复双击坐标采集逻辑

### v3.0
- ✨ 初始版本发布
- ✨ 基础定时任务功能

---

## 🤝 贡献指南

欢迎提交 Issue 和 Pull Request！

```bash
# 1. Fork 项目
git clone https://github.com/yourusername/ClickNow.git

# 2. 创建功能分支
git checkout -b feature/YourFeature

# 3. 提交改动
git commit -m "Add YourFeature"

# 4. 推送到远程
git push origin feature/YourFeature

# 5. 提交 Pull Request
```

---

## 📝 许可证

本项目采用 [MIT License](LICENSE) 开源许可证。

---

## 📞 联系方式

如有问题或建议，欢迎通过以下方式联系：

- 🐛 提交 [Issue](../../issues)
- 💬 参与 [Discussions](../../discussions)
- 📧 邮件联系（见项目主页）

---

## 🙏 致谢

感谢以下项目和社区的支持：

- [AutoJS 项目](https://github.com/hyper-v-org/autojs)
- Android 开发社区
- 所有贡献者和使用者 ❤️

---

<div align="center">

**⭐ 如果这个项目对你有帮助，请给个 Star 支持一下！**

Made with ❤️ by ClickNow Team

</div>
